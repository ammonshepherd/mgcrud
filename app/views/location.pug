extends layout

block content
  if message
    ul.card-panel.green.white-text#success-panel
      li= message
  if errors
    ul.card-panel.red.white-text#error-panel
      for error in errors
        li= error.msg
  if dbErr
    ul.card-panel.red.white-text
      li= dbErr

  if results
    - var access = results.access
    - var action = 'edit'
    - var address = results.address
    - var description = results.description
    - var email = results.email
    - var hours = results.hours
    - var latlong = results.latlong
    - var phone = results.phone
    - var picture = results.picture
    - var placeID = results.id
    - var placeName = results.name
    - var slug = results.slug
    - var website = results.website
    if results.visible
      - var visibleness = 'checked'
  h1#item-edit-title.deep-orange-text.text-lighten-2 #{placeName}

  .row#location-form
    form(action='/locations/edit/' + placeID, method='post' enctype='multipart/form-data')
      .row#form-fields
        .col.s12.m6
          div.input-field(data-role='fieldcontain')
            label(for='placeName') Place Name
            input.validate#placeName(type='text' placeholder='(required)' name='placeName' value=placeName)
          div.input-field(data-role='fieldcontain')
            label.active(for='description') Description
            textarea.materialize-textarea.validate#description(placeholder='(required)' name='description')
              = description
          div.input-field(data-role='fieldcontain')
            label.active(for='address') Address
            input.validate#address(type='text' name='address' value=address)
          div.input-field(data-role='fieldcontain')
            label(for='access') Access (what does it take to get in and use tools)
            input.validate#access(type='text' name='access' value=access)
          div.input-field(data-role='fieldcontain')
            label(for='hours') Hours
            input.validate#hours(type='text' name='hours' value=hours)
          div.input-field(data-role='fieldcontain')
            label.active(for='website') Website
            input.validate#website(type='url' name='website' value=website)
          div.input-field(data-role='fieldcontain')
            label.active(for='email') Email
            input.validate#email(type='email' name='email' value=email)
          div.input-field(data-role='fieldcontain')
            label.active(for='phone') Phone
            input.validate#phone(type='text' name='phone' value=phone)
        .col.s12.m6
          if (picture)
            #location-image
              img.responsive-img(src='/uploads/' + picture)
          else 
            #location-image
              img.responsive-img(src='/images/no-location.png')
          div.input-field.file-field(data-role='fieldcontain')
            .btn
              if (action == 'edit')
                span Add Picture
              else 
                span New Picture
              input.validate#loc_image(type='file' name='loc_image')
              input(type='hidden' name='pic_name' value=picture)
            .file-path-wrapper
              input.file-path.validate(type='text')
          div.input-field(data-role='fieldcontain')
            label.active(for='latlong') Lat/Long
            input.validate#latlong(type='text' name='latlong' value=latlong)
          div.input-field(data-role='fieldcontain')
            label.active.valign-wrapper(for='slug') Slug (for URL = makergrounds.virginia.edu/slug-value-here)
              a.tooltipped(data-position='top' data-tooltip='The "slug" can only contain lowercase letters, numbers, and dashes.')
                i.material-icons help
            input.validate#slug(type='text' pattern='[a-z0-9-]+' name='slug' value=slug)
      .row#visible-box
        .col.s5
          div.input-field(data-role='fieldcontain')
            input#isVisible(type='checkbox' name='visible' checked=visibleness)
            label(for='isVisible') Visible
      .row#form-buttons
        .col.s5
          input.validate.btn.waves-effect.waves-light.green.left#submit(type='submit' name='submit' value='Save')
          if (action == 'edit')
            a.modal-action.modal-close.btn.waves-effect.waves-light.red(href='#delete-' + placeID) Delete
            div(class='modal', id='delete-' + placeID)
              .modal-content
                h4 Delete 
                  span.delete-title= placeName
                p Are you sure you want to delete this item?
              .modal-footer
                a.modal-action.modal-close.btn.green.left(href='#!') Cancel
                a.modal-action.modal-close.btn.red(href='/locations/delete/' + placeID) Delete
